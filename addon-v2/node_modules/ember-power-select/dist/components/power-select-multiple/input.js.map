{"version":3,"file":"input.js","sources":["../../../src/components/power-select-multiple/input.hbs","../../../src/components/power-select-multiple/input.ts"],"sourcesContent":["import { precompileTemplate } from \"@ember/template-compilation\";\nexport default precompileTemplate(\"{{!-- template-lint-disable require-aria-activedescendant-tabindex --}}\\n{{!-- template-lint-disable no-positive-tabindex --}}\\n<input\\n  type=\\\"search\\\"\\n  class=\\\"ember-power-select-trigger-multiple-input\\\"\\n  aria-activedescendant={{if @select.isOpen @ariaActiveDescendant}}\\n  aria-haspopup=\\\"listbox\\\"\\n  aria-expanded={{if @select.isOpen \\\"true\\\" \\\"false\\\"}}\\n  autocomplete=\\\"off\\\"\\n  autocorrect=\\\"off\\\"\\n  autocapitalize=\\\"off\\\"\\n  spellcheck={{false}}\\n  id=\\\"ember-power-select-trigger-multiple-input-{{@select.uniqueId}}\\\"\\n  aria-labelledby={{@ariaLabelledBy}}\\n  aria-describedby={{@ariaDescribedBy}}\\n  aria-label={{@ariaLabel}}\\n  value={{@select.searchText}}\\n  role={{or @role \\\"combobox\\\"}}\\n  aria-owns={{if @select.isOpen @listboxId}}\\n  aria-controls={{if @select.isOpen @listboxId}}\\n  aria-autocomplete=\\\"list\\\"\\n  placeholder={{this.maybePlaceholder}}\\n  disabled={{@select.disabled}}\\n  tabindex={{@tabindex}}\\n  form=\\\"power-select-fake-form\\\"\\n  {{on \\\"focus\\\" @onFocus}}\\n  {{on \\\"blur\\\" @onBlur}}\\n  {{on \\\"input\\\" this.handleInput}}\\n  {{on \\\"keydown\\\" this.handleKeydown}}\\n  ...attributes\\n/>\")","import Component from '@glimmer/component';\nimport { action } from '@ember/object';\nimport { get } from '@ember/object';\nimport { assert } from '@ember/debug';\nimport { isBlank } from '@ember/utils';\nimport type { Select } from '../power-select';\n\ninterface PowerSelectMultipleInputSignature {\n  Element: HTMLElement;\n  Args: {\n    select: Select;\n    placeholder?: string;\n    searchField: string;\n    tabindex?: string;\n    listboxId?: string;\n    ariaLabel?: string;\n    ariaActiveDescendant?: string;\n    ariaLabelledBy?: string;\n    ariaDescribedBy?: string;\n    role?: string;\n    placeholderComponent?: string;\n    isDefaultPlaceholder?: boolean;\n    onInput?: (e: InputEvent) => boolean;\n    onKeydown?: (e: KeyboardEvent) => boolean;\n    onFocus: (e: FocusEvent) => void;\n    onBlur: (e: FocusEvent) => void;\n    buildSelection: (lastSelection: any, select: Select) => any[];\n  };\n}\n\nconst ua = window && window.navigator ? window.navigator.userAgent : '';\nconst isIE = ua.indexOf('MSIE ') > -1 || ua.indexOf('Trident/') > -1;\n\nexport default class PowerSelectMultipleInputComponent extends Component<PowerSelectMultipleInputSignature> {\n  get maybePlaceholder() {\n    if (isIE || !this.args.isDefaultPlaceholder) {\n      return undefined;\n    }\n    return !this.args.select.selected || this.args.select.selected.length === 0\n      ? this.args.placeholder || ''\n      : '';\n  }\n\n  @action\n  handleInput(event: Event): void {\n    const e = event as InputEvent;\n    if (this.args.onInput && this.args.onInput(e) === false) {\n      return;\n    }\n    this.args.select.actions.open(e);\n  }\n\n  @action\n  handleKeydown(event: Event): false | void {\n    const e = event as KeyboardEvent;\n    if (e.target === null) return;\n    if (this.args.onKeydown && this.args.onKeydown(e) === false) {\n      e.stopPropagation();\n      return false;\n    }\n    if (e.keyCode === 8) {\n      e.stopPropagation();\n      if (isBlank((e.target as HTMLInputElement).value)) {\n        const lastSelection =\n          this.args.select.selected &&\n          this.args.select.selected[this.args.select.selected.length - 1];\n        if (lastSelection) {\n          this.args.select.actions.select(\n            this.args.buildSelection(lastSelection, this.args.select),\n            e,\n          );\n          if (typeof lastSelection === 'string') {\n            this.args.select.actions.search(lastSelection);\n          } else {\n            assert(\n              '`<PowerSelectMultiple>` requires a `@searchField` when the options are not strings to remove options using backspace',\n              this.args.searchField,\n            );\n            this.args.select.actions.search(\n              get(lastSelection, this.args.searchField),\n            );\n          }\n          this.args.select.actions.open(e);\n        }\n      }\n    } else if ((e.keyCode >= 48 && e.keyCode <= 90) || e.keyCode === 32) {\n      // Keys 0-9, a-z or SPACE\n      e.stopPropagation();\n    }\n  }\n}\n"],"names":["ua","window","navigator","userAgent","isIE","indexOf","PowerSelectMultipleInputComponent","Component","maybePlaceholder","args","isDefaultPlaceholder","undefined","select","selected","length","placeholder","handleInput","event","e","onInput","actions","open","n","this","prototype","action","handleKeydown","target","onKeydown","stopPropagation","keyCode","isBlank","value","lastSelection","buildSelection","search","assert","searchField","get","setComponentTemplate","TEMPLATE"],"mappings":"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"}